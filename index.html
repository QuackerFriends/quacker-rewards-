<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Your Shop</title>
<style>
:root { --brand-orange: #ff6600; }

body {
  font-family: Arial, sans-serif;
  background: #fafafa;
  color: #333;
  margin: 0;
  padding: 20px;
  text-align: center;
}

h2 {
  color: var(--brand-orange);
}

.category-buttons {
  margin-bottom: 20px;
}

.category-buttons button {
  background: var(--brand-orange);
  color: white;
  border: none;
  border-radius: 999px;
  padding: 8px 16px;
  margin: 4px;
  cursor: pointer;
  font-weight: 600;
}

.category-buttons button:hover {
  background: #e65c00;
}

.product-card {
  background: white;
  border-radius: 16px;
  padding: 12px;
  margin: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  width: 260px;
  display: inline-block;
  vertical-align: top;
}

.product-card img {
  width: 100%;
  border-radius: 12px;
}

.product-card label {
  display: block;
  text-align: left;
  font-weight: 600;
  margin-top: 6px;
}

select {
  width: 100%;
  padding: 6px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin-bottom: 8px;
}

button.add-btn {
  background: var(--brand-orange);
  color: white;
  border: none;
  border-radius: 999px;
  padding: 8px 16px;
  font-weight: 600;
  cursor: pointer;
  width: 100%;
}

button.add-btn:hover {
  background: #e65c00;
}

/* Carousel styling */
.carousel {
  position: relative;
  overflow: hidden;
  border-radius: 12px;
  background: #f6f6f6;
}
.carousel img {
  width: 100%;
  height: 220px;
  object-fit: contain;
  display: none;
  transition: opacity .25s ease;
}
.carousel img.active {
  display: block;
}
.carousel button {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255,255,255,0.85);
  border: none;
  border-radius: 999px;
  width: 34px;
  height: 34px;
  cursor: pointer;
  font-size: 18px;
  color: #333;
}
.carousel .prev-btn { left: 8px; }
.carousel .next-btn { right: 8px; }
.carousel button:hover {
  background: var(--brand-orange);
  color: white;
}
</style>
</head>
<body>

<h2>üõçÔ∏è Welcome to the Shop</h2>
<div class="category-buttons">
  <button onclick="showCategory('tapestry')">Tapestries</button>
  <button onclick="showCategory('tees')">Tees</button>
  <button onclick="showCategory('keychains')">Keychains</button>
</div>

<div id="shop"></div>

<script>
const PRODUCTS = {
  tapestry: [
    {
      id: "forest_tapestry",
      title: "Forest Tapestry",
      price: 0.05,
      images: [
        "https://files.catbox.moe/3lplph.png",
        "https://files.catbox.moe/n8lx8c.png",
        "https://files.catbox.moe/qthm2g.png"
      ]
    },
    {
      id: "sky_tapestry",
      title: "Sky Dreams Tapestry",
      price: 0.05,
      images: [
        "https://files.catbox.moe/9msz4m.png",
        "https://files.catbox.moe/sy6x2u.png"
      ]
    }
  ],
  tees: [
    {
      id: "ghostduck_tee",
      title: "Ghost Duck Tee",
      price: 0.025,
      sizes: ["S", "M", "L", "XL"],
      colors: ["Black", "White", "Pink"],
      images: {
        Black: "https://files.catbox.moe/8txxhf.png",
        White: "https://files.catbox.moe/fjw31l.png",
        Pink: "https://files.catbox.moe/j0z3a9.png"
      }
    }
  ],
  keychains: [
    {
      id: "quackheads_keychain",
      title: "Quackheads Keychain",
      price: 0.015,
      sizes: ["Green Quackhead", "Pink Quackhead", "Mustard Quackhead"],
      colors: ["None", "Gold", "Silver"],
      images: ["https://files.catbox.moe/gnm9n0.png"]
    }
  ]
};

const cart = [];

function showToast(msg,type="success"){
  console.log(msg);
}

function updateCartUI(){
  console.log("Cart:",cart);
}

function addToCart(prodId){
  let product = null;
  for (const cat of Object.keys(PRODUCTS)) {
    product = (PRODUCTS[cat]||[]).find(p=>p.id===prodId);
    if (product) {
      const thumb = Array.isArray(product.images) ? product.images[0]
                    : (typeof product.images === 'object' ? Object.values(product.images)[0] : product.images);
      const colorEl = document.getElementById(`color_${prodId}`);
      const sizeEl = document.getElementById(`size_${prodId}`);
      const color = colorEl ? colorEl.value : "";
      const size = sizeEl ? sizeEl.value : "N/A";
      cart.push({ id: product.id, title: product.title, price: product.price, color, size, q:1, thumb });
      updateCartUI();
      showToast(`${product.title} added to cart`,"success");
      return;
    }
  }
  showToast("Product not found","error");
}

function showCategory(cat){
  const el = document.getElementById("shop");
  el.innerHTML = "";
  const items = PRODUCTS[cat] || [];
  items.forEach(p=>{
    const sizeId = `size_${p.id}`;
    const colorId = `color_${p.id}`;

    let labelText = "Size";
    if (p.id === "quackheads_keychain") labelText = "Top Accessory";

    const sizeSelectHtml = (p.sizes && p.sizes.length) ? `
      <label>${labelText}</label>
      <select id="${sizeId}">
        ${p.sizes.map(s => `<option value="${s}">${s}</option>`).join('')}
      </select>
    ` : '';

    const colorSelectHtml = (p.colors && p.colors.length) ? `
      <label>Color</label>
      <select id="${colorId}">
        ${p.colors.map(c => `<option value="${c}">${c}</option>`).join('')}
      </select>
    ` : '';

    // Image section (carousel or static)
    let imgHtml = '';
    if (Array.isArray(p.images) && p.images.length > 1) {
      imgHtml = `
        <div class="carousel" id="carousel_${p.id}">
          ${p.images.map((img,i)=>`<img src="${img}" class="${i===0?'active':''}">`).join('')}
          <button class="prev-btn">‚Äπ</button>
          <button class="next-btn">‚Ä∫</button>
        </div>
      `;
    } else if (typeof p.images === 'object') {
      const defaultColor = Object.keys(p.images)[0];
      imgHtml = `<img id="img_${p.id}" src="${p.images[defaultColor]}">`;
    } else {
      imgHtml = `<img src="${p.images[0]}" alt="${p.title}">`;
    }

    el.innerHTML += `
      <div class="product-card">
        ${imgHtml}
        <h3>${p.title}</h3>
        <p>${p.price} ETH</p>
        ${sizeSelectHtml}
        ${colorSelectHtml}
        <button class="add-btn" onclick="addToCart('${p.id}')">Add to Cart</button>
      </div>
    `;

    // Carousel setup
    if (Array.isArray(p.images) && p.images.length > 1) setupCarousel(p.id);

    // Color switch for tees
    if (typeof p.images === 'object' && p.colors) {
      const colorSelect = document.getElementById(colorId);
      const imgEl = document.getElementById(`img_${p.id}`);
      colorSelect.addEventListener('change', (e)=>{
        const val = e.target.value;
        if (p.images[val]) imgEl.src = p.images[val];
      });
    }
  });
}

function setupCarousel(id) {
  const carousel = document.getElementById(`carousel_${id}`);
  const imgs = Array.from(carousel.querySelectorAll('img'));
  let index = 0;
  const nextBtn = carousel.querySelector('.next-btn');
  const prevBtn = carousel.querySelector('.prev-btn');

  const setIndex = (newIdx) => {
    imgs[index].classList.remove('active');
    index = newIdx;
    imgs[index].classList.add('active');
  };

  nextBtn.addEventListener('click', ()=> setIndex((index+1)%imgs.length));
  prevBtn.addEventListener('click', ()=> setIndex((index-1+imgs.length)%imgs.length));

  // Swipe
  let startX = null;
  carousel.addEventListener('touchstart', (ev)=> startX = ev.touches[0].clientX);
  carousel.addEventListener('touchend', (ev)=> {
    const diff = ev.changedTouches[0].clientX - startX;
    if (diff > 30) setIndex((index-1+imgs.length)%imgs.length);
    else if (diff < -30) setIndex((index+1)%imgs.length);
    startX = null;
  });

  // Auto-slide every 4s
  setInterval(()=> setIndex((index+1)%imgs.length), 4000);
}

// Default category
showCategory('tapestry');
</script>
</body>
</html>
